exports.id=218,exports.ids=[218],exports.modules={88079:(e,s,a)=>{Promise.resolve().then(a.bind(a,65552))},65552:(e,s,a)=>{"use strict";a.r(s),a.d(s,{ProductForm:()=>w});var r=a(95344),i=a(8428),t=a(60708),l=a(85453),d=a(12374);let o=d.Km(["DASHBOARD","FORM","REPORT","TOOL","OTHER"]),c=d.Km(["DRAFT","ACTIVE","DEPRECATED"]),n=d.Km(["PUBLIC","INTERNAL"]),p=d.Ry({name:d.Z_().min(1,"El nombre es requerido").max(200,"M\xe1ximo 200 caracteres"),type:o,description:d.Z_().max(2e3,"M\xe1ximo 2000 caracteres").optional().nullable(),url:d.Z_().url("Debe ser una URL v\xe1lida").regex(/^https?:\/\//,"La URL debe comenzar con http:// o https://").optional().nullable().or(d.i0("")),owner:d.Z_().max(100,"M\xe1ximo 100 caracteres").optional().nullable(),status:c,visibility:n,eps:d.Z_().max(100,"M\xe1ximo 100 caracteres").optional().nullable(),region:d.Z_().max(100,"M\xe1ximo 100 caracteres").optional().nullable(),district:d.Z_().max(100,"M\xe1ximo 100 caracteres").optional().nullable(),topic:d.Z_().max(100,"M\xe1ximo 100 caracteres").optional().nullable(),period:d.Z_().max(50,"M\xe1ximo 50 caracteres").optional().nullable(),source:d.Z_().max(200,"M\xe1ximo 200 caracteres").optional().nullable(),tags:d.IX(d.Z_()).optional()});d.Ry({q:d.Z_().optional(),page:d.oQ.number().int().positive().default(1),pageSize:d.oQ.number().int().positive().max(100).default(20),type:o.optional(),status:c.optional(),visibility:n.optional(),eps:d.Z_().optional(),region:d.Z_().optional(),district:d.Z_().optional(),topic:d.Z_().optional(),period:d.Z_().optional(),owner:d.Z_().optional(),tags:d.G0([d.Z_(),d.IX(d.Z_())]).optional(),sortBy:d.Km(["updatedAt","name","status","createdAt"]).default("updatedAt"),sortOrder:d.Km(["asc","desc"]).default("desc")});var m=a(16212),x=a(92549),u=a(1586),h=a(3729),f=a(91626);let j=h.forwardRef(({className:e,...s},a)=>r.jsx("textarea",{className:(0,f.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));j.displayName="Textarea";var g=a(17470),b=a(61351),y=a(25092),v=a(2768),N=a(42739);function w({product:e,tags:s}){let a=(0,i.useRouter)(),{toast:d}=(0,y.pm)(),[o,c]=(0,h.useState)(!1),[n,f]=(0,h.useState)(e?.tags?.map(e=>e.tag.name)||[]),[w,_]=(0,h.useState)(""),{register:R,handleSubmit:Z,formState:{errors:E},setValue:A,watch:C}=(0,t.cI)({resolver:(0,l.F)(p),defaultValues:e?{name:e.name,type:e.type,description:e.description||"",url:e.url||"",owner:e.owner||"",status:e.status,visibility:e.visibility,eps:e.eps||"",region:e.region||"",district:e.district||"",topic:e.topic||"",period:e.period||"",source:e.source||"",tags:e.tags?.map(e=>e.tag.name)||[]}:{type:"DASHBOARD",status:"DRAFT",visibility:"INTERNAL",tags:[]}}),T=C("url"),k=async s=>{c(!0);try{let r={...s,tags:n},i=await fetch(e?`/api/products/${e.id}`:"/api/products",{method:e?"PATCH":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(i.ok)d({title:e?"Producto actualizado":"Producto creado",description:`El producto se ha ${e?"actualizado":"creado"} correctamente`}),a.push("/products"),a.refresh();else{let e=await i.json();d({variant:"destructive",title:"Error",description:e.error||"Ocurri\xf3 un error"})}}catch(e){d({variant:"destructive",title:"Error",description:"Ocurri\xf3 un error al guardar el producto"})}finally{c(!1)}},I=()=>{w&&!n.includes(w)&&(f([...n,w]),A("tags",[...n,w]),_(""))},O=e=>{let s=n.filter(s=>s!==e);f(s),A("tags",s)};return(0,r.jsxs)("form",{onSubmit:Z(k),className:"space-y-6",children:[(0,r.jsxs)(b.Zb,{children:[(0,r.jsxs)(b.Ol,{children:[r.jsx(b.ll,{children:"Informaci\xf3n B\xe1sica"}),r.jsx(b.SZ,{children:"Datos principales del producto"})]}),(0,r.jsxs)(b.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"name",children:"Nombre *"}),r.jsx(x.I,{id:"name",...R("name"),disabled:o}),E.name&&r.jsx("p",{className:"text-sm text-destructive",children:E.name.message})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"type",children:"Tipo *"}),(0,r.jsxs)(g.Ph,{value:C("type"),onValueChange:e=>A("type",e),disabled:o,children:[r.jsx(g.i4,{id:"type",children:r.jsx(g.ki,{})}),(0,r.jsxs)(g.Bw,{children:[r.jsx(g.Ql,{value:"DASHBOARD",children:"Dashboard"}),r.jsx(g.Ql,{value:"FORM",children:"Formulario"}),r.jsx(g.Ql,{value:"REPORT",children:"Reporte"}),r.jsx(g.Ql,{value:"TOOL",children:"Herramienta"}),r.jsx(g.Ql,{value:"OTHER",children:"Otro"})]})]}),E.type&&r.jsx("p",{className:"text-sm text-destructive",children:E.type.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"status",children:"Estado *"}),(0,r.jsxs)(g.Ph,{value:C("status"),onValueChange:e=>A("status",e),disabled:o,children:[r.jsx(g.i4,{id:"status",children:r.jsx(g.ki,{})}),(0,r.jsxs)(g.Bw,{children:[r.jsx(g.Ql,{value:"DRAFT",children:"Borrador"}),r.jsx(g.Ql,{value:"ACTIVE",children:"Activo"}),r.jsx(g.Ql,{value:"DEPRECATED",children:"Obsoleto"})]})]}),E.status&&r.jsx("p",{className:"text-sm text-destructive",children:E.status.message})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"visibility",children:"Visibilidad *"}),(0,r.jsxs)(g.Ph,{value:C("visibility"),onValueChange:e=>A("visibility",e),disabled:o,children:[r.jsx(g.i4,{id:"visibility",children:r.jsx(g.ki,{})}),(0,r.jsxs)(g.Bw,{children:[r.jsx(g.Ql,{value:"INTERNAL",children:"Interno"}),r.jsx(g.Ql,{value:"PUBLIC",children:"P\xfablico"})]})]}),E.visibility&&r.jsx("p",{className:"text-sm text-destructive",children:E.visibility.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"description",children:"Descripci\xf3n"}),r.jsx(j,{id:"description",...R("description"),disabled:o,rows:4,placeholder:"Describe el producto..."}),E.description&&r.jsx("p",{className:"text-sm text-destructive",children:E.description.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"url",children:"URL"}),r.jsx(x.I,{id:"url",type:"url",...R("url"),disabled:o,placeholder:"https://..."}),E.url&&r.jsx("p",{className:"text-sm text-destructive",children:E.url.message}),T&&(0,r.jsxs)("a",{href:T,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline flex items-center gap-1",children:[r.jsx(v.Z,{className:"h-3 w-3"}),"Vista previa"]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"owner",children:"Responsable"}),r.jsx(x.I,{id:"owner",...R("owner"),disabled:o,placeholder:"Nombre o email del responsable"}),E.owner&&r.jsx("p",{className:"text-sm text-destructive",children:E.owner.message})]})]})]}),(0,r.jsxs)(b.Zb,{children:[(0,r.jsxs)(b.Ol,{children:[r.jsx(b.ll,{children:"Metadatos SUNASS"}),r.jsx(b.SZ,{children:"Informaci\xf3n espec\xedfica para clasificaci\xf3n"})]}),r.jsx(b.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"eps",children:"EPS"}),r.jsx(x.I,{id:"eps",...R("eps"),disabled:o,placeholder:"Ej: SEDAPAL"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"region",children:"Regi\xf3n"}),r.jsx(x.I,{id:"region",...R("region"),disabled:o,placeholder:"Ej: Lima"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"district",children:"Distrito"}),r.jsx(x.I,{id:"district",...R("district"),disabled:o})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"topic",children:"Tema"}),r.jsx(x.I,{id:"topic",...R("topic"),disabled:o,placeholder:"Ej: Calidad del Agua"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"period",children:"Periodo"}),r.jsx(x.I,{id:"period",...R("period"),disabled:o,placeholder:"Ej: 2025-Q1"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{htmlFor:"source",children:"Fuente"}),r.jsx(x.I,{id:"source",...R("source"),disabled:o,placeholder:"Ej: Sistema SIAS"})]})]})})]}),(0,r.jsxs)(b.Zb,{children:[(0,r.jsxs)(b.Ol,{children:[r.jsx(b.ll,{children:"Tags"}),r.jsx(b.SZ,{children:"Etiquetas para clasificar el producto"})]}),(0,r.jsxs)(b.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(x.I,{value:w,onChange:e=>_(e.target.value),placeholder:"Nuevo tag...",disabled:o,onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),I())}}),r.jsx(m.z,{type:"button",onClick:I,disabled:o||!w,children:"Agregar"})]}),s.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{children:"Tags existentes (click para agregar)"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:s.filter(e=>!n.includes(e.name)).map(e=>r.jsx(m.z,{type:"button",variant:"outline",size:"sm",onClick:()=>{f([...n,e.name]),A("tags",[...n,e.name])},disabled:o,children:e.name},e.id))})]}),n.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(u._,{children:"Tags seleccionados"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(e=>(0,r.jsxs)("div",{className:"inline-flex items-center gap-1 rounded-full bg-primary px-3 py-1 text-sm text-primary-foreground",children:[e,r.jsx("button",{type:"button",onClick:()=>O(e),className:"ml-1 hover:bg-primary-foreground/20 rounded-full p-0.5",disabled:o,children:"\xd7"})]},e))})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)(m.z,{type:"submit",disabled:o,children:[o&&r.jsx(N.Z,{className:"mr-2 h-4 w-4 animate-spin"}),e?"Actualizar":"Crear"," Producto"]}),r.jsx(m.z,{type:"button",variant:"outline",onClick:()=>a.back(),disabled:o,children:"Cancelar"})]})]})}},61351:(e,s,a)=>{"use strict";a.d(s,{Ol:()=>d,SZ:()=>c,Zb:()=>l,aY:()=>n,eW:()=>p,ll:()=>o});var r=a(95344),i=a(3729),t=a(91626);let l=i.forwardRef(({className:e,...s},a)=>r.jsx("div",{ref:a,className:(0,t.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));l.displayName="Card";let d=i.forwardRef(({className:e,...s},a)=>r.jsx("div",{ref:a,className:(0,t.cn)("flex flex-col space-y-1.5 p-6",e),...s}));d.displayName="CardHeader";let o=i.forwardRef(({className:e,...s},a)=>r.jsx("h3",{ref:a,className:(0,t.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));o.displayName="CardTitle";let c=i.forwardRef(({className:e,...s},a)=>r.jsx("p",{ref:a,className:(0,t.cn)("text-sm text-muted-foreground",e),...s}));c.displayName="CardDescription";let n=i.forwardRef(({className:e,...s},a)=>r.jsx("div",{ref:a,className:(0,t.cn)("p-6 pt-0",e),...s}));n.displayName="CardContent";let p=i.forwardRef(({className:e,...s},a)=>r.jsx("div",{ref:a,className:(0,t.cn)("flex items-center p-6 pt-0",e),...s}));p.displayName="CardFooter"},92549:(e,s,a)=>{"use strict";a.d(s,{I:()=>l});var r=a(95344),i=a(3729),t=a(91626);let l=i.forwardRef(({className:e,type:s,...a},i)=>r.jsx("input",{type:s,className:(0,t.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:i,...a}));l.displayName="Input"},1586:(e,s,a)=>{"use strict";a.d(s,{_:()=>c});var r=a(95344),i=a(3729),t=a(14217),l=a(49247),d=a(91626);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=i.forwardRef(({className:e,...s},a)=>r.jsx(t.f,{ref:a,className:(0,d.cn)(o(),e),...s}));c.displayName=t.f.displayName},17470:(e,s,a)=>{"use strict";a.d(s,{Bw:()=>h,Ph:()=>n,Ql:()=>f,i4:()=>m,ki:()=>p});var r=a(95344),i=a(3729),t=a(32116),l=a(25390),d=a(12704),o=a(62312),c=a(91626);let n=t.fC;t.ZA;let p=t.B4,m=i.forwardRef(({className:e,children:s,...a},i)=>(0,r.jsxs)(t.xz,{ref:i,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...a,children:[s,r.jsx(t.JO,{asChild:!0,children:r.jsx(l.Z,{className:"h-4 w-4 opacity-50"})})]}));m.displayName=t.xz.displayName;let x=i.forwardRef(({className:e,...s},a)=>r.jsx(t.u_,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:r.jsx(d.Z,{className:"h-4 w-4"})}));x.displayName=t.u_.displayName;let u=i.forwardRef(({className:e,...s},a)=>r.jsx(t.$G,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:r.jsx(l.Z,{className:"h-4 w-4"})}));u.displayName=t.$G.displayName;let h=i.forwardRef(({className:e,children:s,position:a="popper",...i},l)=>r.jsx(t.h_,{children:(0,r.jsxs)(t.VY,{ref:l,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:a,...i,children:[r.jsx(x,{}),r.jsx(t.l_,{className:(0,c.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),r.jsx(u,{})]})}));h.displayName=t.VY.displayName,i.forwardRef(({className:e,...s},a)=>r.jsx(t.__,{ref:a,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s})).displayName=t.__.displayName;let f=i.forwardRef(({className:e,children:s,...a},i)=>(0,r.jsxs)(t.ck,{ref:i,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(t.wU,{children:r.jsx(o.Z,{className:"h-4 w-4"})})}),r.jsx(t.eT,{children:s})]}));f.displayName=t.ck.displayName,i.forwardRef(({className:e,...s},a)=>r.jsx(t.Z0,{ref:a,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",e),...s})).displayName=t.Z0.displayName},2768:(e,s,a)=>{"use strict";a.d(s,{Z:()=>r});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(69224).Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},92555:(e,s,a)=>{"use strict";a.d(s,{H:()=>d});var r=a(86843);let i=(0,r.createProxy)(String.raw`E:\proyectos_windsurf\catalogo-sunass\components\products\product-form.tsx`),{__esModule:t,$$typeof:l}=i;i.default;let d=(0,r.createProxy)(String.raw`E:\proyectos_windsurf\catalogo-sunass\components\products\product-form.tsx#ProductForm`)}};