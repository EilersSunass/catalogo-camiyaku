(()=>{var e={};e.id=822,e.ids=[822],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},63477:e=>{"use strict";e.exports=require("querystring")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},72746:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>l});var r=s(50482),a=s(69108),i=s(62563),n=s.n(i),d=s(68300),o={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>d[e]);s.d(t,o);let l=["",{children:["(dashboard)",{children:["audit",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,61452)),"E:\\proyectos_windsurf\\catalogo-sunass\\app\\(dashboard)\\audit\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,64214)),"E:\\proyectos_windsurf\\catalogo-sunass\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,35403)),"E:\\proyectos_windsurf\\catalogo-sunass\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}],c=["E:\\proyectos_windsurf\\catalogo-sunass\\app\\(dashboard)\\audit\\page.tsx"],u="/(dashboard)/audit/page",p={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(dashboard)/audit/page",pathname:"/audit",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},72832:(e,t,s)=>{Promise.resolve().then(s.bind(s,44754))},44754:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AuditClient:()=>h});var r=s(95344),a=s(3729),i=s(8428),n=s(61351),d=s(69436),o=s(16212),l=s(17470),c=s(1586),u=s(92549),p=s(25092),x=s(91626),m=s(71532),f=s(97751);function h(){let e=(0,i.useRouter)(),t=(0,i.useSearchParams)(),{toast:s}=(0,p.pm)(),[h,g]=(0,a.useState)([]),[j,v]=(0,a.useState)(null),[y,b]=(0,a.useState)(!0);(0,a.useEffect)(()=>{N()},[t]);let N=async()=>{b(!0);try{let e=new URLSearchParams(t.toString()),s=await fetch(`/api/audit?${e.toString()}`),r=await s.json();g(r.logs),v(r.pagination)}catch(e){s({variant:"destructive",title:"Error",description:"No se pudieron cargar los logs de auditor\xeda"})}finally{b(!1)}},w=(s,r)=>{let a=new URLSearchParams(t.toString());r?a.set(s,r):a.delete(s),a.set("page","1"),e.push(`/audit?${a.toString()}`)},P=s=>{let r=new URLSearchParams(t.toString());r.set("page",s.toString()),e.push(`/audit?${r.toString()}`)},_=e=>{switch(e){case"CREATE":return"success";case"UPDATE":return"default";case"DELETE":return"destructive";case"LOGIN":return"secondary";default:return"outline"}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Auditor\xeda"}),r.jsx("p",{className:"text-muted-foreground",children:"Registro de acciones en el sistema"})]}),(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{children:"Filtros"})}),(0,r.jsxs)(n.aY,{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(c._,{htmlFor:"action",children:"Acci\xf3n"}),(0,r.jsxs)(l.Ph,{value:t.get("action")||"all",onValueChange:e=>w("action","all"===e?"":e),children:[r.jsx(l.i4,{id:"action",children:r.jsx(l.ki,{placeholder:"Todas"})}),(0,r.jsxs)(l.Bw,{children:[r.jsx(l.Ql,{value:"all",children:"Todas"}),r.jsx(l.Ql,{value:"CREATE",children:"Creaci\xf3n"}),r.jsx(l.Ql,{value:"UPDATE",children:"Actualizaci\xf3n"}),r.jsx(l.Ql,{value:"DELETE",children:"Eliminaci\xf3n"}),r.jsx(l.Ql,{value:"LOGIN",children:"Inicio de sesi\xf3n"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(c._,{htmlFor:"entity",children:"Entidad"}),(0,r.jsxs)(l.Ph,{value:t.get("entity")||"all",onValueChange:e=>w("entity","all"===e?"":e),children:[r.jsx(l.i4,{id:"entity",children:r.jsx(l.ki,{placeholder:"Todas"})}),(0,r.jsxs)(l.Bw,{children:[r.jsx(l.Ql,{value:"all",children:"Todas"}),r.jsx(l.Ql,{value:"Product",children:"Producto"}),r.jsx(l.Ql,{value:"User",children:"Usuario"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(c._,{htmlFor:"startDate",children:"Fecha inicio"}),r.jsx(u.I,{id:"startDate",type:"date",value:t.get("startDate")||"",onChange:e=>w("startDate",e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(c._,{htmlFor:"endDate",children:"Fecha fin"}),r.jsx(u.I,{id:"endDate",type:"date",value:t.get("endDate")||"",onChange:e=>w("endDate",e.target.value)})]})]})]}),y?r.jsx("div",{className:"space-y-2",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>r.jsx("div",{className:"h-20 bg-muted animate-pulse rounded-lg"},t))}):0===h.length?r.jsx(n.Zb,{children:r.jsx(n.aY,{className:"py-12 text-center text-muted-foreground",children:"No se encontraron registros"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",h.length," de ",j?.total||0," registros"]}),r.jsx("div",{className:"space-y-2",children:h.map(e=>r.jsx(n.Zb,{children:r.jsx(n.aY,{className:"py-4",children:r.jsx("div",{className:"flex items-start justify-between gap-4",children:(0,r.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(d.C,{variant:_(e.action),children:(0,x.Uj)(e.action)}),r.jsx("span",{className:"font-semibold",children:e.entity}),e.product&&(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:["â†’ ",e.product.name]})]}),r.jsx("div",{className:"text-sm text-muted-foreground",children:e.user?(0,r.jsxs)(r.Fragment,{children:["Por: ",e.user.name||e.user.email]}):"Usuario desconocido"}),r.jsx("div",{className:"text-xs text-muted-foreground",children:(0,x.p6)(e.timestamp)})]})})})},e.id))}),j&&j.totalPages>1&&(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,r.jsxs)(o.z,{variant:"outline",size:"sm",onClick:()=>P(j.page-1),disabled:1===j.page,children:[r.jsx(m.Z,{className:"h-4 w-4"}),"Anterior"]}),r.jsx("div",{className:"flex items-center gap-1",children:(0,r.jsxs)("span",{className:"text-sm",children:["P\xe1gina ",j.page," de ",j.totalPages]})}),(0,r.jsxs)(o.z,{variant:"outline",size:"sm",onClick:()=>P(j.page+1),disabled:j.page===j.totalPages,children:["Siguiente",r.jsx(f.Z,{className:"h-4 w-4"})]})]})]})]})}},69436:(e,t,s)=>{"use strict";s.d(t,{C:()=>d});var r=s(95344);s(3729);var a=s(49247),i=s(91626);let n=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-500 text-white hover:bg-yellow-600"}},defaultVariants:{variant:"default"}});function d({className:e,variant:t,...s}){return r.jsx("div",{className:(0,i.cn)(n({variant:t}),e),...s})}},61351:(e,t,s)=>{"use strict";s.d(t,{Ol:()=>d,SZ:()=>l,Zb:()=>n,aY:()=>c,eW:()=>u,ll:()=>o});var r=s(95344),a=s(3729),i=s(91626);let n=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));n.displayName="Card";let d=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...t}));d.displayName="CardHeader";let o=a.forwardRef(({className:e,...t},s)=>r.jsx("h3",{ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";let l=a.forwardRef(({className:e,...t},s)=>r.jsx("p",{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));l.displayName="CardDescription";let c=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,i.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent";let u=a.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",e),...t}));u.displayName="CardFooter"},92549:(e,t,s)=>{"use strict";s.d(t,{I:()=>n});var r=s(95344),a=s(3729),i=s(91626);let n=a.forwardRef(({className:e,type:t,...s},a)=>r.jsx("input",{type:t,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));n.displayName="Input"},1586:(e,t,s)=>{"use strict";s.d(t,{_:()=>l});var r=s(95344),a=s(3729),i=s(14217),n=s(49247),d=s(91626);let o=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=a.forwardRef(({className:e,...t},s)=>r.jsx(i.f,{ref:s,className:(0,d.cn)(o(),e),...t}));l.displayName=i.f.displayName},17470:(e,t,s)=>{"use strict";s.d(t,{Bw:()=>f,Ph:()=>c,Ql:()=>h,i4:()=>p,ki:()=>u});var r=s(95344),a=s(3729),i=s(32116),n=s(25390),d=s(12704),o=s(62312),l=s(91626);let c=i.fC;i.ZA;let u=i.B4,p=a.forwardRef(({className:e,children:t,...s},a)=>(0,r.jsxs)(i.xz,{ref:a,className:(0,l.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...s,children:[t,r.jsx(i.JO,{asChild:!0,children:r.jsx(n.Z,{className:"h-4 w-4 opacity-50"})})]}));p.displayName=i.xz.displayName;let x=a.forwardRef(({className:e,...t},s)=>r.jsx(i.u_,{ref:s,className:(0,l.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:r.jsx(d.Z,{className:"h-4 w-4"})}));x.displayName=i.u_.displayName;let m=a.forwardRef(({className:e,...t},s)=>r.jsx(i.$G,{ref:s,className:(0,l.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:r.jsx(n.Z,{className:"h-4 w-4"})}));m.displayName=i.$G.displayName;let f=a.forwardRef(({className:e,children:t,position:s="popper",...a},n)=>r.jsx(i.h_,{children:(0,r.jsxs)(i.VY,{ref:n,className:(0,l.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...a,children:[r.jsx(x,{}),r.jsx(i.l_,{className:(0,l.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),r.jsx(m,{})]})}));f.displayName=i.VY.displayName,a.forwardRef(({className:e,...t},s)=>r.jsx(i.__,{ref:s,className:(0,l.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t})).displayName=i.__.displayName;let h=a.forwardRef(({className:e,children:t,...s},a)=>(0,r.jsxs)(i.ck,{ref:a,className:(0,l.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(i.wU,{children:r.jsx(o.Z,{className:"h-4 w-4"})})}),r.jsx(i.eT,{children:t})]}));h.displayName=i.ck.displayName,a.forwardRef(({className:e,...t},s)=>r.jsx(i.Z0,{ref:s,className:(0,l.cn)("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=i.Z0.displayName},71532:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(69224).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},8428:(e,t,s)=>{"use strict";var r=s(14767);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},61452:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(25036),a=s(81355),i=s(3205),n=s(867),d=s(11013),o=s(86843);let l=(0,o.createProxy)(String.raw`E:\proyectos_windsurf\catalogo-sunass\app\(dashboard)\audit\audit-client.tsx`),{__esModule:c,$$typeof:u}=l;l.default;let p=(0,o.createProxy)(String.raw`E:\proyectos_windsurf\catalogo-sunass\app\(dashboard)\audit\audit-client.tsx#AuditClient`);async function x(){let e=await (0,a.getServerSession)(i.L);return e||(0,n.redirect)("/login?callbackUrl=/audit"),(0,d.Pw)(e.user.role)||(0,n.redirect)("/products"),r.jsx("div",{className:"container py-8",children:r.jsx(p,{})})}},11013:(e,t,s)=>{"use strict";function r(e,t,s){return"ADMIN"===e}function a(e,t,s){return"ADMIN"===e||t===s}function i(e){return"ADMIN"===e}function n(e){return"ADMIN"===e}s.d(t,{Ct:()=>a,Pw:()=>i,qi:()=>n,rn:()=>r})},14217:(e,t,s)=>{"use strict";s.d(t,{f:()=>d});var r=s(3729),a=s(62409),i=s(95344),n=r.forwardRef((e,t)=>(0,i.jsx)(a.WV.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var d=n}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[638,753,256,674,241,867,739,534],()=>s(72746));module.exports=r})();